
<%= form_tag(cours_action_do_path) do %>
	<h2><%= params[:action_name] %></h2>
  <br>

	<%= hidden_field_tag :action_name, params[:action_name] %>

  <div class="row">
    <div class="col-sm-12">
      <h4>Cours sélectionnés</h4>

      <ul class="list-group">
        <% if @action_ids %>
          <% @action_ids.each do |id| %>
            <% @cours = Cour.find(id) %>
            
            <li class="list-group-item">
              <%= check_box_tag "[cours_id][#{@cours.id}]", true, true %>
              <%= l(@cours.debut.to_date) %>
              <%= "#{l(@cours.debut, format: :heures_min)}-#{l(@cours.fin, format: :heures_min)}" %> |
              <%= @cours.formation.nom_promo %> |
              <%= @cours.intervenant.nom_prenom %> |
              <% if @cours.intervenant_binome %>
                <%= @cours.intervenant_binome.nom_prenom %> |
              <% end %>
              <span class="label <%= @cours.style %>"><%= @cours.etat.humanize %></span> |
              <%= "Salle: #{@cours.salle.nom} |" if @cours.salle %>
              <%= "Créé par #{User.find(@cours.audits.first.user_id).email}" %>
            </li>
          <% end %>
        <% end %>
      </ul>
    </div>
  </div>

  <% if params[:action_name] == "Changer de salle" %>  
    <div class="row">
    <div class="col-sm-3">
      <%= label_tag "Nouvelle Salle" %>    
      <%= select_tag :salle_id, 
            options_from_collection_for_select(Salle.order(:nom), :id, :nom, params[:salle_id]), 
            include_blank:true, class:"form-control" %>
    </div>
    <div class="col-sm-3">
      <br><br>
      <%= link_to(salles_occupation_path(date:@cours.debut.to_date), target:"_new") do %>
            <span class="glyphicon glyphicon-blackboard"></span>
            Afficher l'occupation des salles
      <% end %>
    </div>
  </div>

  <% elsif params[:action_name] == "Changer d'état" %>
    <div class="col-sm-2">
      <%= label_tag "Nouvel état" %>    
      <%= select_tag :etat, options_for_select(Cour.etats, params[:etat]), include_blank:true, class:"form-control" %>
    </div>
    <div class="col-sm-6">
      <%= label_tag "Notification" %><br>
      <%= check_box_tag :email %> Avertir les étudiants par courriel ? (que pour "annulé" et "reporté")<br> 
      <!--
      <%= check_box_tag :sms %> Informer les étudiants par SMS ?
      -->
      <br><br><br>
    </div>

  <% elsif params[:action_name] == "Changer d'intervenant" %>
    <div class="col-sm-6">
      <%= label_tag "Nouvel intervenant" %>    
      <%= select_tag :intervenant_id, 
                      options_from_collection_for_select(Intervenant.all, :id, :nom_prenom, params[:intervenant_id]), 
                      include_blank:true, class:"form-control" %>
      <br><br>
    </div>

  <% elsif params[:action_name] == "Supprimer" %>
    <div class="col-sm-6">
      <%= label_tag "Confirmation :" %><br>
      <%= check_box_tag :delete %> Suppression définitive de tous les cours sélectionnés ?
      <br>
      <i>Les cours ne peuvent être supprimés que par leur créateur ou un administrateur</i>
      <br><br>
    </div>
  <% end %>

  <div class="row">
    <div class="col-sm-12">
      <%= submit_tag 'Appliquer', class:"btn btn-success" %>
    </div>
  </div>

<% end %>
