<script type="text/javascript">    
    setInterval(function() {
        window.location.reload();
    }, 1*60000); 
</script>

<div class="container-fluid">

  <%= form_tag request.path, method: :get do %>

    <div class="form-group">
      <div class="row">
        
        <div class="col-sm-6">
          <%= label_tag "Date" %>
          <div class="input-group">  
            <%= link_to '<<', cours_path(start_date: (@date - 1.month)), class:"btn btn-default btn-sm" %>
            <%= link_to '<',  cours_path(start_date: (@date - 1.day)), class:"btn btn-default btn-sm" %>

            <%= l(@date.to_date, format: :short).humanize %>
            
            <%= link_to '>',  cours_path(start_date: (@date + 1.day)), class:"btn btn-default btn-sm" %>
            <%= link_to '>>', cours_path(start_date: (@date + 1.month)), class:"btn btn-default btn-sm" %>
            <%= link_to "Aujourd'hui", cours_path(start_date: Date.today), class:"btn btn-default btn-sm" %>
          </div>
        </div>

        <div class="col-sm-6">
          <%= label_tag "Formation" %>    
          <%= select_tag :formation, grouped_options_for_select(Formation.for_select, params[:formation]), class:"form-control", include_blank:true, onchange:'this.form.submit()' %>
        </div>

        <div class="col-sm-5">
          <%= label_tag "Intervenant" %>    
          <div class="input-group">
            <%= select_tag :intervenant, grouped_options_for_select(Intervenant.for_select, params[:intervenant]), class:"form-control", include_blank:true, onchange:'this.form.submit()' %>
            <span class="input-group-btn">
              <%= submit_tag 'Filtrer', class:"btn btn-success" %>
            </span>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <% if @cours.any? %>
    <% @cours.includes(:formation, :intervenant, :salle).each do | cours | %>

      <%= render partial: 'cours', locals: {cours: cours, cours_progress_bar_pct: cours.progress_bar_pct(DateTime.now) } %>

    <% end %>
    <hr>
  <% end %>
</div>


