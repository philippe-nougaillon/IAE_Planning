<div class="page-header">
  <% if current_user.admin? %>
    <%= link_to formations_path, class: 'btn btn-default' do %>
      <span class="glyphicon glyphicon-list-alt"></span>
      Retour
    <% end %>
    <%= link_to edit_formation_path(@formation), class: 'btn btn-primary' do %>
      <span class="glyphicon glyphicon-pencil"></span>
      Modifier
    <% end %>
  <% end %>
  
  <h2>
    <%= @formation.nom %>
  </h2>

</div>

<dl class="dl-horizontal">
</dl>

<p>
  <strong>Promo:</strong>
  <%= @formation.promo %>
</p>

<p>
  <strong>Diplôme:</strong>
  <%= @formation.diplome %>
</p>

<p>
  <strong>Domaine:</strong>
  <%= @formation.domaine %>
</p>

<p>
  <strong>Apprentissage:</strong>
  <%= @formation.apprentissage ? "Oui" : "Non" %>
</p>

<p>
  <strong>Nbr étudiants:</strong>
  <%= @formation.nbr_etudiants %>
</p>

<p>
  <strong>Nbr d'heures planifiées:</strong>
  <%= link_to @formation.cours.planifié.collect {|c| c.duree }.sum, cours_path(formation_id:@formation, etat:1)  %>
</p>

<p>
  <strong>Nbr d'utilisateurs associés:</strong>
  <%= link_to @formation.users.count, users_path(formation_id: @formation.id) %>
</p>

<p>
  <strong>Mémo:</strong>
  <%= @formation.memo %>
</p>

<h3>Unités d'Enseignement</h3>
<p>
  <ul>
  <% @formation.unites.each do | unite | %>
    <li>
      <%= link_to unite.num, cours_path(formation_id:@formation, ue:unite.num) %> 
      <b><%= unite.nom %></b> 
      (<%= @formation.cours.where(ue:unite.num).count %> cours/
       <%= @formation.cours.where(ue:unite.num).collect {|c| c.duree }.sum %>h)
    </li>
  <% end %> 
  </ul>
</p>
<br>

<% if @formation.documents.any? %>
  <h3>Documents</h3>
  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>Nom</th>
          <th>UE</th>
          <th>Intervenant</th>
          <th>Voir</th>
        </tr>
      </thead>

      <tbody>
        <%= content_tag_for(:tr, @formation.documents) do |document| %>
            <td><%= document.nom %></td>
            <td><%= document.unite.num_nom %></td>
            <td><%= document.intervenant.nom_prenom %></td>
            <td>
              <%= link_to document.fichier.url, class: "btn btn-default" do %>
                <i class="glyphicon glyphicon-eye-open"></i>
              <% end %>
            </td>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>
